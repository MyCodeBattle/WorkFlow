# 数据入库流程

## 记录数据

在数据来源表中记录，具体略。



## 数据准备

这个步骤需要人工对数据做一些处理，方便程序导入。


### 1.复制原表

为了保留原始数据，需要复制一份 Sheet，重命名自己定。

### 2.更改字段

#### 不需要复制的字段

##### 2.1 NAME字段

一般为**接触人**姓名字段，重命名为**NAME**。

#####2.2 AERA1字段

一般为接触人区县字段，如果没有的话需手工加一列，重命名为**AREA1**。

##### 2.3 AERA2字段

一般为接触人乡镇字段，如果没有的话需手工加一列，重命名为**AREA2**。


##### 2.4 ADDR字段

一般为**最精确的地址字段**，直接替换原列名，重命名为**ADDR**。

#### 需要复制的字段

##### 2.5 PHONE字段

一般为接触人手机字段，需**复制原手机列**，重命名为**PHONE**。

##### 2.6 PID字段

一般为接触人的身份证字段，需**复制原身份证列**，重命名为**PID**。


##### 2.7 PATIANTNAME字段

患者姓名字段，拼接备注用。需**复制原列**，重命名为**PATIENTNAME**。

##### 2.8 CRITERION字段

判断密接依据字段，拼接备注用。需**复制原列**，重命名为**CRITERION**。

##### 2.9 TOUCHTIME字段

密接时间字段，拼接备注用。需**复制原列**，重命名为**TOUCHTIME**。

##### 2.10 EXTRA字段

目前暂时取**航班号、车次**的字段。以后考虑扩展成多个相关信息字段拼接。需**复制原列**，重命名为EXTRA。



##### 2.11 其他ADDR字段

如果文档中存在多个地址字段，为了方便随访员排查，需全部拼接入备注。程序会以下列格式呈现：【暂住地址】：鹿城区政府【常口地址】温州市政府。

如果有需要拼接的地址字段，**需复制原列，在原列名前面加ADDR+数字**。

例如原列名为`常口地址`，需复制一列，重命名为`ADDR2常口地址`。



## 启动程序

复制Sheet名称、文件路径到程序里，启动！

理论上如果进行了上述步骤应该没问题。

### 检查入库情况

目前有三种情况不会入库：

- 身份证重复
- 手机号重复
- 区县和乡镇同时为空
- 手机号和身份证同时为空

需要人工处理的是后两种情况。

## 登记

对程序入库后的情况进行登记。